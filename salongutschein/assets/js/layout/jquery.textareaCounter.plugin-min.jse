!function(a){a.fn.textareaCount=function(e,t){e=a.extend({maxCharacterSize:-1,originalStyle:"originalTextareaInfo",warningStyle:"warningTextareaInfo",warningNumber:20,displayFormat:"#input characters | #words words",maxLines:3},e);var r=a(this);a("<div class='charleft'>&nbsp;</div>").insertAfter(r);var i={width:r.width()},n=function(a){return a.next(".charleft")}(r);n.addClass(e.originalStyle),n.css(i);var l=0,o=e.maxCharacterSize,s=0,c=0;function u(){return n.html(function(){var t=r.val(),i=t.length;if(e.maxCharacterSize>0){if(i>e.maxCharacterSize){if("plz"==r.attr("id")||"telefon"==r.attr("id")||"mobil"==r.attr("id")||"diffPlz"==r.attr("id")||"diffTelefon"==r.attr("id")||"diffMobil"==r.attr("id"))var u="Ziffern";else u="Zeichen";a("#errorAuswahl > div").empty().append("Maximal "+e.maxCharacterSize+" "+u+" erlaubt."),a("#errorAuswahl").dialog({buttons:[{text:"Ok",click:function(){a(this).dialog("close")}}],draggable:!1,title:"Hinweis",modal:!0}),t=t.substring(0,e.maxCharacterSize)}var v=d(t),m=e.maxCharacterSize-v;if(f()||(m=e.maxCharacterSize),i>m){var p=this.scrollTop;r.val(t.substring(0,m)),this.scrollTop=p}n.removeClass(e.warningStyle),m-i<=e.warningNumber&&n.addClass(e.warningStyle),l=r.val().length+v,f()||(l=r.val().length),c=g(h(r.val())),s=o-l}else{v=d(t);l=r.val().length+v,f()||(l=r.val().length),c=g(h(r.val()))}var x=r.val(),w=(x.match(/\n/g)||[]).length+1;if(w>e.maxLines){var b=x.split("\n"),C=0;x="",a.each(b,(function(a,e){C++,x+=e,x+=C<w-1?"\n":" "})),r.val(x),a("#errorAuswahl > div").empty().append("Maximal "+e.maxLines+" Zeilen erlaubt."),a("#errorAuswahl").dialog({buttons:[{text:"Ok",click:function(){a(this).dialog("close")}}],draggable:!1,title:"Hinweis",modal:!0})}return function(){var a=e.displayFormat;a=(a=a.replace("#input",l)).replace("#words",c),o>0&&(a=(a=a.replace("#max",o)).replace("#left",s));return a}()}()),void 0!==t&&t.call(this,{input:l,max:o,left:s,words:c}),!0}function f(){return-1!=navigator.appVersion.toLowerCase().indexOf("win")}function d(a){for(var e=0,t=0;t<a.length;t++)"\n"==a.charAt(t)&&e++;return e}function h(a){var e=(a+" ").replace(/^[^A-Za-z0-9]+/gi,""),t=rExp=/[^A-Za-z0-9]+/gi;return e.replace(t," ").split(" ")}function g(a){return a.length-1}r.bind("keyup",(function(a){u()})).bind("paste",(function(a){setTimeout((function(){u()}),10)}))}}(jQuery);